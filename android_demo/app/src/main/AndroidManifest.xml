<?xml version="1.0" encoding="utf-8"?>
<!--
    AndroidManifest.xml - 应用清单文件
    
    这是 Android 应用的核心配置文件，定义了：
    1. 应用需要的权限
    2. 应用组件（Activity、Service 等）
    3. 应用的基本属性
    
    重要权限说明：
    - INTERNET: 与 AIstudio 服务器通信
    - RECORD_AUDIO: 语音输入功能
    - SYSTEM_ALERT_WINDOW: 在其他应用上层显示（执行操作时需要）
    - ACCESSIBILITY_SERVICE: 无障碍服务（用于自动化操作）
-->
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools">

    <!-- ========================================== -->
    <!-- 权限声明区域                               -->
    <!-- ========================================== -->
    
    <!-- 网络权限 - 与 AIstudio 部署的 server.py 通信 -->
    <uses-permission android:name="android.permission.INTERNET" />
    
    <!-- 网络状态权限 - 检查网络连接状态 -->
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
    
    <!-- 录音权限 - 用于语音输入功能 -->
    <uses-permission android:name="android.permission.RECORD_AUDIO" />
    
    <!-- 系统悬浮窗权限 - 在其他应用上显示操作提示 -->
    <uses-permission android:name="android.permission.SYSTEM_ALERT_WINDOW" />
    
    <!-- 前台服务权限 - 保持服务在后台运行 -->
    <uses-permission android:name="android.permission.FOREGROUND_SERVICE" />
    <uses-permission android:name="android.permission.FOREGROUND_SERVICE_SPECIAL_USE" />

    <!-- ========================================== -->
    <!-- 应用配置区域                               -->
    <!-- ========================================== -->
    <application
        android:allowBackup="true"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/Theme.AutoGLMPhoneDemo"
        android:usesCleartextTraffic="true"
        tools:targetApi="31">
        
        <!-- 
            android:usesCleartextTraffic="true" 
            允许 HTTP 明文传输（非 HTTPS）
            因为 AIstudio 部署的服务可能使用 HTTP
            生产环境建议使用 HTTPS
        -->

        <!-- ========================================== -->
        <!-- 主界面 Activity                           -->
        <!-- ========================================== -->
        <activity
            android:name=".MainActivity"
            android:exported="true"
            android:label="@string/app_name"
            android:theme="@style/Theme.AutoGLMPhoneDemo">
            
            <!-- 声明为启动入口 -->
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <!-- ========================================== -->
        <!-- 无障碍服务（用于自动化操作）               -->
        <!-- ========================================== -->
        <service
            android:name=".AutomationAccessibilityService"
            android:exported="true"
            android:permission="android.permission.BIND_ACCESSIBILITY_SERVICE"
            android:label="@string/accessibility_service_label">
            
            <intent-filter>
                <action android:name="android.accessibilityservice.AccessibilityService" />
            </intent-filter>
            
            <!-- 无障碍服务配置 -->
            <meta-data
                android:name="android.accessibilityservice"
                android:resource="@xml/accessibility_service_config" />
        </service>

    </application>

</manifest>
